<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHRIMPTECH - Simple Contact Test</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; padding: 20px; background: #f5f5f5; }
        .container { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: 600; }
        input, select, textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 16px; }
        button { background: #0066cc; color: white; padding: 12px 24px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
        button:disabled { background: #ccc; }
        .log { background: #f8f9fa; border: 1px solid #dee2e6; padding: 15px; border-radius: 5px; font-family: monospace; max-height: 300px; overflow-y: auto; white-space: pre-wrap; margin-top: 20px; }
        h1 { color: #0066cc; text-align: center; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ü¶ê SHRIMPTECH Simple Contact Test</h1>
        
        <form id="contactForm">
            <div class="form-group">
                <label for="name">H·ªç v√† t√™n *</label>
                <input type="text" id="name" name="name" value="Tr·∫ßn Minh Hi·∫øu" required>
            </div>
            
            <div class="form-group">
                <label for="email">Email *</label>
                <input type="email" id="email" name="email" value="minhhieu.test@gmail.com" required>
            </div>
            
            <div class="form-group">
                <label for="phone">S·ªë ƒëi·ªán tho·∫°i *</label>
                <input type="tel" id="phone" name="phone" value="0835749407" required>
            </div>
            
            <div class="form-group">
                <label for="company">C√¥ng ty</label>
                <input type="text" id="company" name="company" value="SHRIMPTECH Test Company">
            </div>
            
            <div class="form-group">
                <label for="farmType">Lo·∫°i ao nu√¥i *</label>
                <select id="farmType" name="farmType" required>
                    <option value="">Ch·ªçn lo·∫°i ao</option>
                    <option value="pond-small" selected>Ao tr√≤n n·ªïi (50-700m¬≤)</option>
                    <option value="pond-medium">Ao l√≥t b·∫°t ƒë√°y (700‚Äì1.000m¬≤)</option>
                    <option value="pond-large">Ao si√™u th√¢m canh (1.000‚Äì3.000m¬≤)</option>
                    <option value="research">Nghi√™n c·ª©u/H·ªçc thu·∫≠t</option>
                    <option value="other">Kh√°c</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="subject">Ch·ªß ƒë·ªÅ quan t√¢m *</label>
                <select id="subject" name="subject" required>
                    <option value="">Ch·ªçn ch·ªß ƒë·ªÅ</option>
                    <option value="product-info" selected>Th√¥ng tin s·∫£n ph·∫©m</option>
                    <option value="consultation">T∆∞ v·∫•n h·ªá th·ªëng</option>
                    <option value="technical">T∆∞ v·∫•n k·ªπ thu·∫≠t</option>
                    <option value="installation">L·∫Øp ƒë·∫∑t & b·∫£o tr√¨</option>
                    <option value="partnership">H·ª£p t√°c ƒë·∫°i l√Ω</option>
                    <option value="research">H·ª£p t√°c nghi√™n c·ª©u</option>
                    <option value="other">Kh√°c</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="message">N·ªôi dung tin nh·∫Øn *</label>
                <textarea id="message" name="message" rows="4" required>Xin ch√†o SHRIMPTECH team!

T√¥i quan t√¢m ƒë·∫øn h·ªá th·ªëng IoT th√¥ng minh cho nu√¥i t√¥m c·ªßa c√¥ng ty. Vui l√≤ng t∆∞ v·∫•n th√™m v·ªÅ:
- T√≠nh nƒÉng gi√°m s√°t ch·∫•t l∆∞·ª£ng n∆∞·ªõc
- Chi ph√≠ l·∫Øp ƒë·∫∑t v√† v·∫≠n h√†nh
- Th·ªùi gian tri·ªÉn khai d·ª± √°n

C·∫£m ∆°n!</textarea>
            </div>
            
            <div class="form-group">
                <label>
                    <input type="checkbox" id="newsletter" name="newsletter" checked>
                    ƒêƒÉng k√Ω nh·∫≠n tin t·ª©c d·ª± √°n
                </label>
            </div>
            
            <button type="submit">G·ª≠i li√™n h·ªá</button>
        </form>
        
        <div id="status"></div>
        <div id="log" class="log">S·∫µn s√†ng g·ª≠i form...\n</div>
    </div>

    <script>
        function log(message) {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.textContent += `[${timestamp}] ${message}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
            setTimeout(() => statusDiv.innerHTML = '', 8000);
        }

        document.getElementById('contactForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            
            submitBtn.disabled = true;
            submitBtn.textContent = 'ƒêang g·ª≠i...';
            
            try {
                // Collect form data
                const formData = new FormData(this);
                const data = {
                    name: formData.get('name'),
                    email: formData.get('email'),
                    phone: formData.get('phone'),
                    company: formData.get('company'),
                    farmType: formData.get('farmType'),
                    subject: formData.get('subject'),
                    message: formData.get('message'),
                    newsletter: formData.get('newsletter') === 'on'
                };

                log('üìß Preparing to send contact form...');
                log('Data: ' + JSON.stringify(data, null, 2));

                // Try different endpoints
                const endpoints = [
                    'http://localhost:3001/api/contact',
                    'http://127.0.0.1:3001/api/contact'
                ];

                let success = false;
                let lastError = null;

                for (const endpoint of endpoints) {
                    try {
                        log(`üåê Trying endpoint: ${endpoint}`);
                        
                        const response = await fetch(endpoint, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Accept': 'application/json'
                            },
                            body: JSON.stringify(data),
                            mode: 'cors'
                        });

                        log(`üì° Response: ${response.status} ${response.statusText}`);

                        if (response.ok) {
                            const result = await response.json();
                            log(`‚úÖ SUCCESS: ${result.message}`);
                            showStatus(`‚úÖ ${result.message}`, 'success');
                            
                            // Reset form
                            this.reset();
                            success = true;
                            break;
                        } else {
                            const errorText = await response.text();
                            log(`‚ùå HTTP Error ${response.status}: ${errorText}`);
                            lastError = `HTTP ${response.status}: ${errorText}`;
                        }
                    } catch (error) {
                        log(`‚ùå Network Error: ${error.message}`);
                        lastError = error.message;
                    }
                }

                if (!success) {
                    throw new Error(lastError || 'Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn server');
                }

            } catch (error) {
                log(`‚ùå FINAL ERROR: ${error.message}`);
                showStatus(`‚ùå L·ªói: ${error.message}. Vui l√≤ng li√™n h·ªá tr·ª±c ti·∫øp: shrimptech.vhu.hutech@gmail.com`, 'error');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        });

        // Log system info
        log('üåê User Agent: ' + navigator.userAgent);
        log('üìç Current URL: ' + window.location.href);
        log('üîó Origin: ' + window.location.origin);
    </script>
</body>
</html>
